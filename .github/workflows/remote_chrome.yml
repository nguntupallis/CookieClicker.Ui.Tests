name: Chrome

on:
  push:
    branches:
      - master
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v2
        
      - name: Build Docker image
        uses: docker/build-push-action@v2
        with:
          context: ..
          file: ./CookieClicker.dockerfile
          push: false
          tags: cc-tests:latest

      - name: Start Selenium Grid
        run: docker run --rm -d -p 4444:4444 -p 7900:7900 --shm-size 2g selenium/standalone-chrome:dev

      - name: Run tests
        run: docker run --network host -e WebDriver=remote -e Test_Browser=chrome cc-tests

